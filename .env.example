# Persistor — Environment Variable Reference
# Copy this file to .env and fill in values for local development.
# Never commit .env to version control.

# ── Database ──────────────────────────────────────────────────────────────────

# PostgreSQL connection string (required)
# Use sslmode=disable for local dev; remote hosts require SSL.
DATABASE_URL=postgres://persistor:changeme@localhost:5432/persistor?sslmode=disable

# Maximum number of database connections in the pool (2–200)
DB_MAX_CONNS=21

# ── Server ────────────────────────────────────────────────────────────────────

# HTTP API listen port (1–65535)
PORT=3030

# Listen address — must be a loopback address (127.0.0.1, ::1, or localhost)
LISTEN_HOST=127.0.0.1

# Prometheus metrics listen port — must differ from PORT
METRICS_PORT=9091

# ── CORS ──────────────────────────────────────────────────────────────────────

# Comma-separated list of allowed CORS origins (no wildcards)
CORS_ORIGINS=http://localhost:3002

# ── Embeddings ────────────────────────────────────────────────────────────────

# Ollama API endpoint — must be localhost
OLLAMA_URL=http://localhost:11434

# Ollama embedding model name
EMBEDDING_MODEL=qwen3-embedding:0.6b

# Output dimension of the embedding model (1–4096)
EMBEDDING_DIMENSIONS=1024

# Number of background embedding worker goroutines (1–16)
EMBED_WORKERS=4

# ── Encryption ────────────────────────────────────────────────────────────────

# Encryption backend: "static" (env key) or "vault" (HashiCorp Vault)
ENCRYPTION_PROVIDER=static

# AES-256 key as 64 hex characters (32 bytes) — required when ENCRYPTION_PROVIDER=static
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=

# HashiCorp Vault address — used when ENCRYPTION_PROVIDER=vault
VAULT_ADDR=http://127.0.0.1:8200

# HashiCorp Vault token — required when ENCRYPTION_PROVIDER=vault
VAULT_TOKEN=

# ── Logging ───────────────────────────────────────────────────────────────────

# Log level: trace, debug, info, warn, error, fatal, panic
LOG_LEVEL=info

# ── Development ───────────────────────────────────────────────────────────────

# Enable GraphQL Playground UI at /api/v1/graphql/playground (true/false)
ENABLE_PLAYGROUND=false
